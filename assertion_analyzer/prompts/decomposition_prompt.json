{
  "name": "decomposition_prompt",
  "version": "6.0",
  "description": "Decompose free-form assertions into atomic S+G units - every G MUST have an S parent (G1-G10)",
  "source": "GPT-5 optimization sessions 018-020 (2025-11-30), v6.0 enforces S parent for all G",
  "system_prompt": "You are an expert in requirements decomposition for the WBP (Workback Plan) framework. Your task is to break down free-form assertions into atomic S+G units. CRITICAL: Every G assertion MUST have an S parent - S checks if something exists, G checks if the value/identity matches the source. Return structured JSON only.",
  "user_prompt_template": "Decompose this free-form assertion into ATOMIC S+G units.\n\n=== ASSERTION ===\n\"{assertion_text}\"\n\n=== CRITICAL DESIGN PRINCIPLE ===\nEvery G assertion MUST have an S parent:\n- S (Structural): Checks IF something exists in the response\n- G (Grounding): Checks if the VALUE/IDENTITY matches the source\n\nExample: \"don't introduce attendees other than Alice and Bob\"\n- S4 (Participant Identification): Response should list attendees\n- G2 (Attendee Grounding): Attendees must be [\"Alice\", \"Bob\"]\n- G1 (Hallucination Prevention): No additional attendees beyond those listed\n\nNEVER return s_dimension: null. Always find the appropriate S dimension.\n\n=== S DIMENSIONS (Structural - what must exist) ===\nS1: Title - meeting/event title or name\nS2: Timeline Alignment - time constraints, tight timeline disclosure, dependency ordering\nS3: Ownership Assignment - task owner assignment\nS4: Participant Identification - attendees, stakeholders, constraints on who\nS5: Task Dates - when tasks are scheduled (before/after T₀)\nS6: Risk Assessment - risks, mitigation, escalation, dependencies, blockers\nS8: Task Descriptions - what tasks involve\nS9: Success Criteria - definition of done\nS10: Buffer Time - contingency or slack time\nS16: Assumptions & Prerequisites - stated assumptions\nS17: Dependencies - task dependencies, cross-team coordination\nS18: Milestones - key checkpoints\nS19: Communication Plan - sharing, notification actions\nS20: Review & Approval - review cycles, sign-offs\n\n=== G DIMENSIONS (Grounding - values must match source) ===\nG1: Hallucination Prevention - no invented details beyond source (use with S to constrain scope)\nG2: Attendee Grounding - person names match source\nG3: Date/Time Grounding - dates/times match source (includes milestones)\nG4: Artifact Grounding - files/documents match source\nG5: Topic Grounding - topics/subjects match source\nG6: Action Item Grounding - tasks match source\nG7: Role Grounding - roles match source\nG8: Constraint Grounding - limits match source\nG9: Planner-Generated Consistency - generated content consistent\nG10: Relation Grounding - relationships (DEPENDS_ON, OWNS, BLOCKS, PRODUCES) match source\n\n=== SLOT NAMES BY G DIMENSION ===\nG1: [CONSTRAINT] (always paired with another G to specify what not to hallucinate)\nG2: [OWNER], [ATTENDEE], [PERSON]\nG3: [DATE], [TIME], [DATETIME], [TIMEZONE], [DEADLINE], [MILESTONE]\nG4: [ARTIFACT], [FILE], [DOCUMENT]\nG5: [SUBJECT], [TOPIC], [PURPOSE]\nG6: [TASK], [ACTION], [ACTION_ITEM]\nG7: [ROLE]\nG8: [CONSTRAINT], [LIMIT]\nG9: [ASSUMPTION], [BLOCKER], [MITIGATION]\nG10: [DEPENDS_ON], [OWNS], [BLOCKS], [PRODUCES], [REQUIRES_INPUT]\n\n=== S→G MAPPINGS ===\nS1 → G5 (title is a topic)\nS2 → G3, G6, G10 (timeline + dependency ordering relations)\nS3 → G2, G6, G10 (owner name + task + OWNS relation)\nS4 → G2, G7, G1 (attendee names + roles + no hallucinated attendees)\nS5 → G3, G6 (task dates + action items)\nS6 → G2, G6, G7, G9, G10 (dependencies, blockers, DEPENDS_ON/BLOCKS relations)\nS16 → G5, G6, G9 (assumptions about topics/tasks)\nS17 → G2, G3, G6, G10 (cross-team dependencies + relations)\nS18 → G3, G6 (milestone dates + checkpoint tasks)\nS19 → G2, G4, G6 (share with person, artifact, action)\n\n=== OUTPUT FORMAT ===\nEach S assertion must have:\n- s_dimension: REQUIRED - never null (find appropriate S)\n- s_template: Template with [SLOT_NAME] placeholders\n- s_literal: Literal form with actual values filled in\n- linked_g: Array of G dimensions with slot_name and slot_value\n\n=== DECOMPOSITION RULES ===\n1. Split into ATOMIC units - each unit = ONE S dimension\n2. EVERY unit MUST have an s_dimension (never null)\n3. \"Don't hallucinate X\" → find S dimension for X, add G1 + specific G\n4. Use descriptive [SLOT_NAME] in template that matches G dimension\n5. s_literal should be human-readable with quoted values\n6. Return ONLY JSON array, no extra text\n7. Use ONLY G1-G10 dimensions (no G11+)\n\n=== EXAMPLES ===\n\nExample 1 (Multi-S decomposition):\nInput: \"state that the meeting '1:1 Review' is scheduled for July 26 at 14:00 PST\"\nOutput:\n[\n  {\n    \"s_dimension\": \"S1\", \"s_name\": \"Title\",\n    \"s_template\": \"The response should state the meeting [SUBJECT]\",\n    \"s_literal\": \"The response should state the meeting '1:1 Review'\",\n    \"linked_g\": [{\"g_dimension\": \"G5\", \"slot_name\": \"SUBJECT\", \"slot_value\": \"1:1 Review\"}]\n  },\n  {\n    \"s_dimension\": \"S5\", \"s_name\": \"Task Dates\",\n    \"s_template\": \"The response should state the meeting is scheduled for [DATETIME]\",\n    \"s_literal\": \"The response should state the meeting is scheduled for July 26 at 14:00 PST\",\n    \"linked_g\": [{\"g_dimension\": \"G3\", \"slot_name\": \"DATETIME\", \"slot_value\": \"July 26 at 14:00 PST\"}]\n  }\n]\n\nExample 2 (Single S with multiple G):\nInput: \"assign Tisa Odonoghue as owner for confirming agenda and distributing pre-reads\"\nOutput:\n[\n  {\n    \"s_dimension\": \"S3\", \"s_name\": \"Ownership Assignment\",\n    \"s_template\": \"The response should assign [OWNER] as owner for [TASK]\",\n    \"s_literal\": \"The response should assign 'Tisa Odonoghue' as owner for 'confirming agenda' and 'distributing pre-reads'\",\n    \"linked_g\": [\n      {\"g_dimension\": \"G2\", \"slot_name\": \"OWNER\", \"slot_value\": \"Tisa Odonoghue\"},\n      {\"g_dimension\": \"G6\", \"slot_name\": \"TASK\", \"slot_value\": [\"confirming agenda\", \"distributing pre-reads\"]}\n    ]\n  }\n]\n\nExample 3 (Communication with artifacts and deadline):\nInput: \"share pre-reads referencing 'Report.xlsx' and 'Guide.docx' by July 26, 00:15 PST\"\nOutput:\n[\n  {\n    \"s_dimension\": \"S19\", \"s_name\": \"Communication Plan\",\n    \"s_template\": \"The response should include sharing pre-read materials [ARTIFACT] by [DEADLINE]\",\n    \"s_literal\": \"The response should include sharing pre-read materials 'Report.xlsx' and 'Guide.docx' by July 26, 00:15 PST\",\n    \"linked_g\": [\n      {\"g_dimension\": \"G4\", \"slot_name\": \"ARTIFACT\", \"slot_value\": [\"Report.xlsx\", \"Guide.docx\"]},\n      {\"g_dimension\": \"G3\", \"slot_name\": \"DEADLINE\", \"slot_value\": \"July 26, 00:15 PST\"}\n    ]\n  }\n]\n\nExample 4 (Anti-hallucination - MUST have S parent):\nInput: \"not introduce any attendee other than Tisa Odonoghue and Nila Tanguma\"\nOutput:\n[\n  {\n    \"s_dimension\": \"S4\", \"s_name\": \"Participant Identification\",\n    \"s_template\": \"The response should list only [ATTENDEE] as participants\",\n    \"s_literal\": \"The response should list only 'Tisa Odonoghue' and 'Nila Tanguma' as participants\",\n    \"linked_g\": [\n      {\"g_dimension\": \"G2\", \"slot_name\": \"ATTENDEE\", \"slot_value\": [\"Tisa Odonoghue\", \"Nila Tanguma\"]},\n      {\"g_dimension\": \"G1\", \"slot_name\": \"CONSTRAINT\", \"slot_value\": null, \"constraint\": \"no additional attendees beyond those listed\"}\n    ]\n  }\n]\n\nExample 5 (Milestone checkpoint):\nInput: \"include a mid-week milestone to confirm OpenSCAP details\"\nOutput:\n[\n  {\n    \"s_dimension\": \"S18\", \"s_name\": \"Milestones\",\n    \"s_template\": \"The response should include [MILESTONE] to confirm [TASK]\",\n    \"s_literal\": \"The response should include 'mid-week milestone' to confirm 'OpenSCAP details'\",\n    \"linked_g\": [\n      {\"g_dimension\": \"G3\", \"slot_name\": \"MILESTONE\", \"slot_value\": \"mid-week milestone\"},\n      {\"g_dimension\": \"G6\", \"slot_name\": \"TASK\", \"slot_value\": \"confirm OpenSCAP details\"}\n    ]\n  }\n]\n\n=== NOW DECOMPOSE ===\nReturn ONLY a JSON array of atomic units. EVERY unit MUST have s_dimension (never null).",
  "output_schema": {
    "type": "array",
    "items": {
      "type": "object",
      "required": ["s_dimension", "s_name", "s_template", "s_literal", "linked_g"],
      "properties": {
        "s_dimension": {
          "type": "string",
          "description": "S dimension code (S1-S20) - REQUIRED, never null"
        },
        "s_name": {
          "type": "string",
          "description": "S dimension name - REQUIRED"
        },
        "s_template": {
          "type": "string",
          "description": "Template form with [SLOT_NAME] placeholders"
        },
        "s_literal": {
          "type": "string",
          "description": "Literal form with actual values for human readability"
        },
        "linked_g": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "g_dimension": {"type": "string", "pattern": "^G([1-9]|10)$", "description": "G1-G10 only"},
              "slot_name": {"type": "string", "description": "Name of the slot (e.g., SUBJECT, DATETIME, OWNER)"},
              "slot_value": {"type": ["string", "array", "null"]},
              "constraint": {"type": "string", "description": "Optional constraint description for G1"}
            }
          }
        }
      }
    }
  },
  "temperature": 0.2,
  "notes": [
    "Version 6.0: BREAKING CHANGE - Every G MUST have an S parent (no more s_dimension: null)",
    "Design principle: S checks IF something exists, G checks if VALUE matches source",
    "G1 (Hallucination Prevention) is now always paired with another G under an S parent",
    "Added [MILESTONE] to G3 slots for milestone dates",
    "Added S4 → G1 mapping for anti-hallucination of attendees",
    "Added S18 → G3, G6 mapping for milestone checkpoints",
    "Rule 7: Use ONLY G1-G10 dimensions (no G11+) to prevent hallucination",
    "Example 4 changed from pure G to S4 + G2 + G1",
    "Example 5 added for milestone checkpoints (fixes G18 hallucination issue)",
    "Version 5.0: Added G10 (Relation Grounding)",
    "Version 4.0: Added template + literal forms"
  ]
}
